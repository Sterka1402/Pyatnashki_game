(()=>{"use strict";window.addEventListener("load",(()=>{new class{constructor(t){const i=[];for(let e=0;e<t*t-1;e++)i[e]=e+1;i[t*t-1]="",this.tilesWin=i,this.tilesWin1514=[1,2,3,4,5,6,7,8,9,10,11,12,13,15,14,""],this.length=t*t,this.container=document.createElement("DIV"),this.renderTiles=this.renderTiles.bind(this),this.beginGame=this.beginGame.bind(this),this.shuffle=this.shuffle.bind(this),this.moveToEmpty=this.moveToEmpty.bind(this),this.checkTheEndOfGame=this.checkTheEndOfGame.bind(this)}init(){const t=document.querySelector(".game-begin"),i=document.createElement("BUTTON");i.innerHTML="Start new Game",i.classList.add("start-game"),this.container.classList.add("container"),t.append(i,this.container),JSON.parse(localStorage.getItem("tiles"))?(this.tiles=JSON.parse(localStorage.getItem("tiles")),this.renderTiles(this.tiles)):this.renderTiles(this.tilesWin),i.addEventListener("click",this.beginGame)}beginGame(){this.tiles=[...this.tilesWin],this.shuffle(this.tiles),this.renderTiles(this.tiles)}shuffle(t){for(let i=t.length-1;i>0;i--){const e=Math.floor(Math.random()*(i+1)),s=t[e];t[e]=t[i],t[i]=s}return t}renderTiles(t){this.container.innerHTML="",t.forEach((t=>{new class{constructor(t){this.name=t}render(t){const i=document.createElement("div");i.innerHTML=`\n    <p>${this.name}</p>\n    `,i.classList.add("tiles"),i.setAttribute("data-key",`${this.name}`),""===this.name&&i.classList.add("empty"),t.append(i)}}(t).render(this.container)})),this.container.addEventListener("click",this.moveToEmpty),localStorage.setItem("tiles",JSON.stringify(this.tiles))}async moveToEmpty(t){const i=t.target.closest("DIV"),e=this.tiles.findIndex((t=>t===Number(i.dataset.key)));if(""===this.tiles[e-1]&&e%4!=0){const t=this.tiles[e-1];this.tiles[e-1]=this.tiles[e],this.tiles[e]=t}if(""===this.tiles[e+1]&&(e+1)%4!=0){const t=this.tiles[e+1];this.tiles[e+1]=this.tiles[e],this.tiles[e]=t}if(""===this.tiles[e-4]){const t=this.tiles[e-4];this.tiles[e-4]=this.tiles[e],this.tiles[e]=t}if(""===this.tiles[e+4]){const t=this.tiles[e+4];this.tiles[e+4]=this.tiles[e],this.tiles[e]=t}try{await localStorage.setItem("tiles",JSON.stringify(this.tiles)),await this.renderTiles(this.tiles),await this.checkTheEndOfGame()}catch(t){console.log(new Error("Sorry for inconvenience. Something went wrong"))}}checkTheEndOfGame(){if(JSON.stringify(this.tiles)===JSON.stringify(this.tilesWin)||JSON.stringify(this.tiles)===JSON.stringify(this.tilesWin1514))return alert("You Win!")}}(4).init(4)}))})();